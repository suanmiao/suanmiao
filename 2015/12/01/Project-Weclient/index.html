<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Project-Weclient · 蒜白</title><meta name="description" content="Project Brief
Description: WeChat official account management application (Open Source)
Platform: Android
Contribution: over 530,000 users, 130 stars and 50 forks on Github
Relating Techniques:  Java, Android Components, Android Widgets, HTML DOM, Cookie, Regex
Duration:  2013.11 - 2015.5
Team member: Hongkun Leng(Developer), Hong Xiao(Product Designer), Bin Fan(Product Designer) 

B"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">博客</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">微博</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Project-Weclient</h1><div class="post-meta"><div class="post-time">Dec 1, 2015</div></div><div class="post-content"><h2 id="Project_Brief">Project Brief</h2><ul>
<li><strong>Description:</strong> WeChat official account management application (Open Source)</li>
<li><strong>Platform:</strong> Android</li>
<li><strong>Contribution:</strong> over 530,000 users, 130 stars and 50 forks on Github</li>
<li><strong>Relating Techniques:</strong>  Java, Android Components, Android Widgets, HTML DOM, Cookie, Regex</li>
<li><strong>Duration: </strong> 2013.11 - 2015.5</li>
<li><strong>Team member:</strong> Hongkun Leng(Developer), Hong Xiao(Product Designer), Bin Fan(Product Designer) </li>
</ul>
<h2 id="Background:">Background:</h2><p>Originally(before May 2015), there is no official mobile application for account management, the only way was to login to official website, which was limited by location and time. However, most frequently behavior, message view and reply, happens randomly. So there is a high demand for account management features on mobile devices.</p>
<p>Webpage for Wechat official account management</p>
<p><img src="/img/weclient/Before_login.png" alt="Alt text"></p>
<h2 id="Process">Process</h2><h4 id="1-Developed_login_simulating_framework">1.Developed login simulating framework</h4><p>  In order to implement management features on mobile, we have to get necessary data about each operation, while there is no official API for us to execute such operation. So the only way we can do is by simulating HTTP request as it is on the webpage.<br>  For every HTTP request, there are some fundamental elements we have to know</p>
<ul>
<li>Target server URL</li>
<li>Method(POST, GET, DELETE)</li>
<li>Method Parameters</li>
<li>Necessary Header parameters</li>
</ul>
<p>In order to get these elements, I use Chrome Console, a perfect tool for web developer, on which we can get every elements for each HTTP requests<br><img src="/img/weclient/General Info.png" alt="Alt text"></p>
<p>There are some basic techniques relating to simulating requests</p>
<ul>
<li>MD5 encryption (official encryption for password transmission and storage is MD5, a widely used encryption)</li>
<li>Cookie management, parse Cookie, store Cookie, read Cookie</li>
</ul>
<p>After simulating necessary requests, we can get the same HTML code as webpage version. Thus, we have to parse HTML structure of the result and get what we need.<br>For example:<br>  <img src="/img/weclient/Result.png" alt="Alt text"></p>
<h4 id="2-Developed_Message_magement_function">2.Developed Message magement function</h4><p>After simulating necessary functions, the second step is to implement features. The most frequently used feature for Wechat account owners is message management. Due to the random distribution of fans(people who follow this account), message are received randomly, so account users have to wait in front of their desktop if there is no mobile application.  </p>
<p>After simulating functions, we can get message data like this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">"msg_item"</span>:[&#123;<span class="string">"id"</span>:<span class="number">401082279</span>,<span class="string">"type"</span>:<span class="number">2</span>,<span class="string">"fakeid"</span>:<span class="string">"355421075"</span>,<span class="string">"nick_name"</span>:<span class="string">"蒜苗白菜"</span>,<span class="string">"date_time"</span>:<span class="number">1449148933</span>,<span class="string">"source"</span>:<span class="string">""</span>,<span class="string">"msg_status"</span>:<span class="number">0</span>,<span class="string">"has_reply"</span>:<span class="number">0</span>,<span class="string">"refuse_reason"</span>:<span class="string">""</span>,<span class="string">"multi_item"</span>:[],<span class="string">"to_uin"</span>:<span class="number">2390625095</span>&#125;,</span><br><span class="line">&#123;<span class="string">"id"</span>:<span class="number">401082278</span>,<span class="string">"type"</span>:<span class="number">2</span>,<span class="string">"fakeid"</span>:<span class="string">"355421075"</span>,<span class="string">"nick_name"</span>:<span class="string">"蒜苗白菜"</span>,<span class="string">"date_time"</span>:<span class="number">1449148925</span>,<span class="string">"source"</span>:<span class="string">""</span>,<span class="string">"msg_status"</span>:<span class="number">0</span>,<span class="string">"has_reply"</span>:<span class="number">0</span>,<span class="string">"refuse_reason"</span>:<span class="string">""</span>,<span class="string">"multi_item"</span>:[],<span class="string">"to_uin"</span>:<span class="number">2390625095</span>&#125;,</span><br><span class="line">&#123;<span class="string">"id"</span>:<span class="number">401082277</span>,<span class="string">"type"</span>:<span class="number">1</span>,<span class="string">"fakeid"</span>:<span class="string">"355421075"</span>,<span class="string">"nick_name"</span>:<span class="string">"蒜苗白菜"</span>,<span class="string">"date_time"</span>:<span class="number">1449148906</span>,<span class="string">"content"</span>:<span class="string">"Test message two "</span>,<span class="string">"source"</span>:<span class="string">""</span>,<span class="string">"msg_status"</span>:<span class="number">0</span>,<span class="string">"has_reply"</span>:<span class="number">0</span>,<span class="string">"refuse_reason"</span>:<span class="string">""</span>,<span class="string">"multi_item"</span>:[],<span class="string">"to_uin"</span>:<span class="number">2390625095</span>&#125;,</span><br><span class="line">&#123;<span class="string">"id"</span>:<span class="number">401082275</span>,<span class="string">"type"</span>:<span class="number">1</span>,<span class="string">"fakeid"</span>:<span class="string">"355421075"</span>,<span class="string">"nick_name"</span>:<span class="string">"蒜苗白菜"</span>,<span class="string">"date_time"</span>:<span class="number">1449148900</span>,<span class="string">"content"</span>:<span class="string">"Test message one "</span>,<span class="string">"source"</span>:<span class="string">""</span>,<span class="string">"msg_status"</span>:<span class="number">0</span>,<span class="string">"has_reply"</span>:<span class="number">0</span>,<span class="string">"refuse_reason"</span>:<span class="string">""</span>,<span class="string">"multi_item"</span>:[],<span class="string">"to_uin"</span>:<span class="number">2390625095</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>
<p>Obviously, this set of data is in JSON format, and we can serialize it into corresponding JSON object list.</p>
<p>There are some basic element in each “Message Object”</p>
<ul>
<li>id: the unique identify number for each message</li>
<li>fakeid: the id of user who send this message</li>
<li>nick_name: nick name for the sending user</li>
<li>to_uin: the id of official account to whom this message is sending</li>
<li>content: content of this message</li>
<li>date_time: time when this message was created</li>
</ul>
<p>After analyse, there are some relating features and their HTTP request URL</p>
<ul>
<li><strong>get message</strong>:    <a href="https://mp.weixin.qq.com/cgi-bin/message" target="_blank" rel="external">https://mp.weixin.qq.com/cgi-bin/message</a></li>
<li><strong>star message</strong>:  <a href="https://mp.weixin.qq.com/cgi-bin/setstarmessage" target="_blank" rel="external">https://mp.weixin.qq.com/cgi-bin/setstarmessage</a></li>
<li><strong>reply message</strong>:      <a href="https://mp.weixin.qq.com/cgi-bin/singlesend" target="_blank" rel="external">https://mp.weixin.qq.com/cgi-bin/singlesend</a></li>
</ul>
<p>Finally, we implement these features on mobile with user-friendly user interface</p>
<p>Relating techniques</p>
<ul>
<li>ListView, ViewPager Widget </li>
<li>MVVM software architectural pattern</li>
<li>Media Player component</li>
</ul>
<p><img src="/img/weclient/message_list_1.jpeg" alt="Alt text"></p>
<p>For better user experience, We even develop a one-to-one chat page for each conversation</p>
<p><img src="/img/weclient/message_chat.jpeg" alt="Alt text"></p>
<h4 id="3-Developed_Fans_management_function">3.Developed Fans management function</h4><p>In the same way, we parse and clip result for fans list</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">groupsList : (&#123;<span class="string">"groups"</span>:[&#123;<span class="string">"id"</span>:<span class="number">0</span>,<span class="string">"name"</span>:<span class="string">"未分组"</span>,<span class="string">"cnt"</span>:<span class="number">9</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">1</span>,<span class="string">"name"</span>:<span class="string">"黑名单"</span>,<span class="string">"cnt"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">2</span>,<span class="string">"name"</span>:<span class="string">"星标组"</span>,<span class="string">"cnt"</span>:<span class="number">1</span>&#125;,</span><br><span class="line">&#123;<span class="string">"id"</span>:<span class="number">101</span>,<span class="string">"name"</span>:<span class="string">"safsdaf"</span>,<span class="string">"cnt"</span>:<span class="number">0</span>&#125;]&#125;).groups,</span><br><span class="line">                        friendsList : (&#123;<span class="string">"contacts"</span>:[&#123;<span class="string">"id"</span>:<span class="number">3040136284</span>,<span class="string">"nick_name"</span>:<span class="string">"Yun"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">3179091161</span>,<span class="string">"nick_name"</span>:<span class="string">"未必美好"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">1281585781</span>,<span class="string">"nick_name"</span>:<span class="string">"Chensq"</span>,<span class="string">"remark_name"</span>:<span class="string">"陈水强"</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">1211335984</span>,<span class="string">"nick_name"</span>:<span class="string">"侦探们的镇魂歌"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">2</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">1175038025</span>,<span class="string">"nick_name"</span>:<span class="string">"李恒"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">2149997763</span>,<span class="string">"nick_name"</span>:<span class="string">"阿宽"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">791213410</span>,<span class="string">"nick_name"</span>:<span class="string">"为你喝采"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">2088220861</span>,<span class="string">"nick_name"</span>:<span class="string">"相信自己"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">355421075</span>,<span class="string">"nick_name"</span>:<span class="string">"蒜苗白菜"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;,&#123;<span class="string">"id"</span>:<span class="number">517884615</span>,<span class="string">"nick_name"</span>:<span class="string">"小宏"</span>,<span class="string">"remark_name"</span>:<span class="string">""</span>,<span class="string">"group_id"</span>:<span class="number">0</span>&#125;]&#125;</span><br></pre></td></tr></table></figure>
<p>Then display these data in a user-friendly UI</p>
<p>Relating technique:</p>
<ul>
<li>Dialog component</li>
<li>Popup Window component</li>
<li>Bitmap decoding</li>
<li>Fast cache </li>
</ul>
<p><img src="/img/weclient/fans_list.jpeg" alt="Alt text"></p>
<p>Fans profile editing feature:</p>
<p><img src="/img/weclient/edit_fans.jpeg" alt="Alt text"></p>
<p>Fans alias editing feature:</p>
<p><img src="/img/weclient/edit_fans_alias.jpeg" alt="Alt text"></p>
<h4 id="4-Notification_function">4.Notification function</h4><p>Taking full advantage of mobile platform, we use Notification API on Android system to alert users when there is new message while the app is running on background.</p>
<p>Relating technique:</p>
<ul>
<li>Notification API</li>
<li>Service component</li>
<li>Activity task mode</li>
</ul>
<h4 id="5-Open_Source">5.Open Source</h4><p>Although it’s a fully functional application, it’s still unofficial, we gain no support or authority from Wechat Platform, and we are only students whose credibility are limited. So, in order to show our honesty and enhance our credibility, we decide to publish our source code onto Github. The project page link: <a href="https://github.com/suanmiao/weclient" target="_blank" rel="external">https://github.com/suanmiao/weclient</a></p>
<blockquote>
<p>By now, without any promotion and advertisement, this opensource project has been starred by 130 developers and forked by 50 developers.<br>Really exciting and inspiring. It’s the first time that I fully take part in opensource community and firmly feel the super magic power of community, the influence of individuals can be amplified by the opensource community. </p>
</blockquote>
<h3 id="Contribution">Contribution</h3><p>Without doubt, our app, as the first mobile app for account management, free account managers from desktop and they can  reply, edit message at any time. Besides that, we are also among rare developers who can release their project as opensource and be open to any advice and feedback. Consequently, we get 130 stars half a year after our release on Github. </p>
<h3 id="Milestone:">Milestone:</h3><ul>
<li>2013.12 —— Open Source project published</li>
<li>2013.12 —— First public beta version released (although there were some usability problems, we were consistently working on it)</li>
<li>2014.01 —— 500 users. This time we add feedback feature on app, and the first feedback from users was praise!</li>
<li>2014.06 —— 50 stars on Github</li>
<li>2014.07 —— 1500 users</li>
<li>2014.06 —— 100 stars on Github</li>
<li>2014.11 —— 10000 users. I can never imagine we could get such a large user base.</li>
<li>2013.03 —— 50000 users. Another surprise and inspire!</li>
</ul>
<h2 id="Tool_Used:">Tool Used:</h2><ul>
<li>Design: Photoshop</li>
<li>Request Analysis: Chrome, Python “request” library</li>
<li>Programming: Eclipse, AndroidStudio</li>
<li>Performance Optimisation: MAT plugin, (Android)Device Monitor plugin</li>
</ul>
<h2 id="Relating_Links:">Relating Links:</h2><p><a href="http://www.wandoujia.com/apps/com.suan.weclient" target="_blank" rel="external">SnapPea App Market(Wandoujia)</a> , <a href="http://shouji.baidu.com/soft/item?docid=6014819&amp;from=as&amp;f=search_app_%E5%85%AC%E4%BC%97%E5%B9%B3%E5%8F%B0%40list_1_title%401%40header_all_input" target="_blank" rel="external">Baidu App market</a><br><a href="https://github.com/suanmiao/weclient" target="_blank" rel="external">Opensrouce project on Github</a>  </p>
</div></article></div></section><footer><div class="paginator"><a class="prev"> </a><a href="/2015/11/28/hello-world/" class="next">下一篇</a></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>